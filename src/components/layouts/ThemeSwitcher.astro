---
let id = Math.random()
---

<button
  id={`theme-switcher-${id}`}
  class="border-neutral-200 bg-secondary dark:border-neutral-700 dark:bg-neutral-800 relative inline-flex h-8 w-16 items-center rounded-full border"
  role="switch"
  aria-checked="false"
>
  <span class="sr-only">Toggle theme</span>
  <span
    class="translate-x-1 bg-white dark:translate-x-9 dark:bg-neutral-900 inline-block h-6 w-6 transform-all rounded-full p-1"
  >
    <span class="hidden dark:inline">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50">
        <path
          d="M 43.81 29.354 C 43.688 28.958 43.413 28.626 43.046 28.432 C 42.679 28.238 42.251 28.198 41.854 28.321 C 36.161 29.886 30.067 28.272 25.894 24.096 C 21.722 19.92 20.113 13.824 21.683 8.133 C 21.848 7.582 21.697 6.985 21.29 6.578 C 20.884 6.172 20.287 6.022 19.736 6.187 C 10.659 8.728 4.691 17.389 5.55 26.776 C 6.408 36.163 13.847 43.598 23.235 44.451 C 32.622 45.304 41.28 39.332 43.816 30.253 C 43.902 29.96 43.9 29.647 43.81 29.354 Z"
          fill="#FFCE31"></path>
      </svg>
    </span>
    <span class="dark:hidden">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none">
        <circle cx="12" cy="12" r="5.754" fill="#FFCE31"></circle>
        <circle
          cx="3.09"
          cy="6.855"
          r="1.711"
          transform="rotate(-60 3.09 6.855)"
          fill="#FFCE31"></circle>
        <circle
          cx="3.09"
          cy="17.144"
          r="1.711"
          transform="rotate(-120 3.09 17.144)"
          fill="#FFCE31"></circle>
        <circle cx="12" cy="22.288" r="1.711" fill="#FFCE31"></circle>
        <circle
          cx="20.91"
          cy="17.144"
          r="1.711"
          transform="rotate(-60 20.91 17.144)"
          fill="#FFCE31"></circle>
        <circle
          cx="20.91"
          cy="6.855"
          r="1.711"
          transform="rotate(-120 20.91 6.855)"
          fill="#FFCE31"></circle>
        <circle cx="12" cy="1.711" r="1.711" fill="#FFCE31"></circle>
      </svg>
    </span>
  </span>
</button>

<script is:inline define:vars={{ id }}>
  const themeSwitcher = document.getElementById(`theme-switcher-${id}`)

  if (
    localStorage.theme === 'dark' ||
    (!('theme' in localStorage) &&
      window.matchMedia('(prefers-color-scheme: dark)').matches)
  ) {
    themeSwitcher.setAttribute('aria-checked', 'true')
  } else {
    themeSwitcher.setAttribute('aria-checked', 'false')
  }

  themeSwitcher.addEventListener('click', () => {
    if (localStorage.theme === 'dark') {
      localStorage.theme = 'light'
      document.documentElement.classList.remove('dark')
      themeSwitcher.setAttribute('aria-checked', 'false')
    } else {
      localStorage.theme = 'dark'
      document.documentElement.classList.add('dark')
      themeSwitcher.setAttribute('aria-checked', 'true')
    }
  })
</script>
